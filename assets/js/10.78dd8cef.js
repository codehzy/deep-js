(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{559:function(v,_,e){v.exports=e.p+"assets/img/v8-engine.af825a14.png"},560:function(v,_,e){v.exports=e.p+"assets/img/changtoast.e365d713.png"},561:function(v,_,e){v.exports=e.p+"assets/img/v8-origin.3e0e6d15.png"},582:function(v,_,e){"use strict";e.r(_);var t=e(10),o=Object(t.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h2",{attrs:{id:"v8-引擎的原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#v8-引擎的原理"}},[v._v("#")]),v._v(" V8 引擎的原理")]),v._v(" "),t("h3",{attrs:{id:"_1-官方定义"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-官方定义"}},[v._v("#")]),v._v(" 1. "),t("strong",[v._v("官方定义")])]),v._v(" "),t("ul",[t("li",[t("code",[v._v("V8")]),v._v(" 是用 C ++编写的 "),t("code",[v._v("Google")]),v._v(" 开源高性能 "),t("code",[v._v("JavaScript")]),v._v(" 和 "),t("code",[v._v("WebAssembly")]),v._v(" 引擎，它用于 "),t("code",[v._v("Chrome")]),v._v(" 和 Node.js 等。")]),v._v(" "),t("li",[v._v("它实现 "),t("code",[v._v("ECMAScript")]),v._v(" 和 "),t("code",[v._v("WebAssembly")]),v._v("，并在 Windows 7 或更高版本，macOS 10.12+和使用 x64，IA-32， ARM 或 MIPS 处理器的 Linux 系统上运行。")]),v._v(" "),t("li",[v._v("V8 可以独立运行，也可以嵌入到任何 C ++应用程序中。")])]),v._v(" "),t("h3",{attrs:{id:"_2-v8-引擎架构图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-v8-引擎架构图"}},[v._v("#")]),v._v(" 2. V8 引擎架构图")]),v._v(" "),t("p",[t("img",{attrs:{src:e(559),alt:"V8 引擎架构图"}})]),v._v(" "),t("ul",[t("li",[t("strong",[v._v("Parse：转换器")]),v._v(" "),t("ul",[t("li",[v._v("我们可以将写的代码复制到下面网站，查看编译出的"),t("a",{attrs:{href:"https://astexplorer.net/",target:"_blank",rel:"noopener noreferrer"}},[v._v("语法树"),t("OutboundLink")],1),v._v("。")]),v._v(" "),t("li",[t("img",{attrs:{src:e(560),alt:"Parse转换"}})])])]),v._v(" "),t("li",[t("strong",[v._v("Ignition：解释器")]),v._v(" "),t("ul",[t("li",[v._v("它可以将我们的代码转换成字节码")]),v._v(" "),t("li",[v._v("最终运行的时候，"),t("code",[v._v("V8")]),v._v(" 帮助我们将字节码转换成 "),t("code",[v._v("CPU")]),v._v(" 指令，最终计算机执行")])])]),v._v(" "),t("li",[t("strong",[v._v("TurboFan：编译器")]),v._v(" "),t("ul",[t("li",[v._v("根据 "),t("code",[v._v("Ignition")]),v._v(" 来收集一些经常执行的函数，将其函数标记为 "),t("code",[v._v("HOT")])]),v._v(" "),t("li",[v._v("根据 "),t("code",[v._v("HOT")]),v._v(" 标记，可以直接将函数转换成机器指令（提高执行效率）")]),v._v(" "),t("li",[v._v("如果函数的返回值由于传入参数导致返回类型不一样（因此 TS 代码编译出来，在一定程度上比 JS 代码要执行的效率高），那么 "),t("code",[v._v("Deoptimization")]),v._v(" 则会反向转换成"),t("strong",[v._v("字节码")])]),v._v(" "),t("li",[v._v("然后根据字节码的流程再走一次。")])])]),v._v(" "),t("li",[t("strong",[v._v("Orinoco：垃圾回收")]),v._v(" "),t("ul",[t("li",[v._v("具体看 JS 内存管理文章")])])])]),v._v(" "),t("h3",{attrs:{id:"_3-v8-引擎的解析图-官方"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-v8-引擎的解析图-官方"}},[v._v("#")]),v._v(" 3. V8 引擎的解析图（官方）")]),v._v(" "),t("p",[t("img",{attrs:{src:e(561),alt:"V8 引擎的解析图（官方）"}})]),v._v(" "),t("ul",[t("li",[v._v("我们的 "),t("code",[v._v("JavaScript")]),v._v(" 源码是如何被解析(Parse 过程)的呢?")]),v._v(" "),t("li",[t("code",[v._v("Blink")]),v._v(" 将源码交给 "),t("code",[v._v("V8")]),v._v(" "),t("code",[v._v("引擎，Stream")]),v._v(" 获取到源码并且进行编码转换;")]),v._v(" "),t("li",[t("code",[v._v("Scanner")]),v._v(" 会进行词法分析(lexical analysis)，"),t("strong",[v._v("词法分析")]),v._v("会将代码转换成 tokens;")]),v._v(" "),t("li",[v._v("接下来 "),t("code",[v._v("tokens")]),v._v(" 会被转换成 "),t("code",[v._v("AST")]),v._v(" 树，经过 "),t("code",[v._v("Parser")]),v._v(" 和 "),t("code",[v._v("PreParser")]),v._v(":\n"),t("ul",[t("li",[t("code",[v._v("Parser")]),v._v(" 就是直接将 "),t("code",[v._v("tokens")]),v._v(" 转成 "),t("code",[v._v("AST")]),v._v(" 树架构")]),v._v(" "),t("li",[t("code",[v._v("PreParser")]),v._v(" 称之为预解析，为什么需要预解析呢?\n"),t("ul",[t("li",[v._v("这是因为并不是所有的 "),t("code",[v._v("JavaScript")]),v._v(" 代码，在一开始时就会被执行。那么对所有的 "),t("code",[v._v("JavaScript")]),v._v(" 代码进行解析，必然会 影响网页的运行效率;")]),v._v(" "),t("li",[v._v("所以 "),t("code",[v._v("V8")]),v._v(" 引擎就实现了"),t("strong",[v._v("Lazy Parsing(延迟解析)的方案")]),v._v("，它的作用是"),t("strong",[v._v("将不必要的函数进行预解析")]),v._v("，也就是只解析暂 时需要的内容，而对"),t("strong",[v._v("函数的全量解析")]),v._v("是在"),t("strong",[v._v("函数被调用时")]),v._v("才会进行;")])])])])]),v._v(" "),t("li",[v._v("生成 "),t("code",[v._v("AST")]),v._v(" 树后，会被 "),t("code",[v._v("Ignition")]),v._v(" 转成字节码(bytecode)，之后的过程就是代码的执行过程。")])])])}),[],!1,null,null,null);_.default=o.exports}}]);